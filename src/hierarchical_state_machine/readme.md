Based on the code from "State Oriented Programming Hierarchical State Machines
in C/C++" by Miro Samek and Paul Y. Montgomery May 13, 2000.
